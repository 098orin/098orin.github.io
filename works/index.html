<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="canonical" href="https://098orin.github.io/works/">
  <link rel="stylesheet" href="../style.css">
  <title>WORKS | 098orin.github.io</title>
  <!-- Open Graph -->
  <meta property="og:url" content="https://098orin.github.io/works/">
  <meta property="og:title" content="WORKS | 098orin.github.io">
  <meta property="og:description" content="私のプロジェクト">
  <!-- end Open Graph -->
  <meta name="robots" content="index, follow">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-JE7CQLY5RL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-JE7CQLY5RL');
  </script>
  <!-- end Google tag (gtag.js) -->
  <style>
  .work-card {
    position: relative;
    border: 1px solid #ddd;
    border-radius: 12px;
    padding: 15px;
    margin: 15px 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    background: #323246;
    transition: transform 0.2s;
  }

  .work-card:hover {
    transform: translateY(-3px);
  }

  .work-readme {
    max-height: 200px; 
    overflow-y: auto;
    border-top: 1px solid #eee;
    padding-top: 10px;
    margin-top: 10px;
    position: relative;
    z-index: 1;
  }

  .read-more-button {
    display: inline-block;
    padding: 6px 12px;
    margin-top: 10px;
    background-color: #0366d6;
    color: #fff;
    border-radius: 6px;
    cursor: pointer;
    text-decoration: none;
    font-size: 0.9rem;
  }

  .read-more-button:hover {
    background-color: #024ea2;
  }

  /* 半透明オーバーレイ全文 */
  .read-more-overlay {
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    background: rgba(19, 15, 33, 0.95);
    overflow-y: auto;
    padding: 15px;
    box-sizing: border-box;
    border-radius: 12px;
    display: none;
    z-index: 10;
  }

  .read-more-overlay .close-button {
    display: inline-block;
    margin-bottom: 10px;
    padding: 4px 10px;
    background-color: #0366d6;
    color: #fff;
    border-radius: 6px;
    cursor: pointer;
    text-decoration: none;
    font-size: 0.9rem;
  }

  .read-more-overlay .close-button:hover {
    background-color: #024ea2;
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

</head>
<body>
  <nav class="main-nav">
    <ul>
      <li><a href="https://098orin.github.io/">TOP</a></li>
      <li><a href="https://098orin.github.io/works/">WORKS</a></li>
      <li><a href="https://098orin.github.io/history/">HISTORY</a></li>
      <li><a href="https://098orin.github.io/tools">TOOLS</a></li>
    </ul>
  </nav>
  <main>
    <h1>Works</h1>
    <p>私のプロジェクト</p>
    <h3>GitHub</h3>
    <div class="work-card">
      <h4>TurboWarp extensions</h4>
      <a href="https://github.com/098orin/tw-extensions" target="_blank" rel="noopener noreferrer">
        https://github.com/098orin/tw-extensions
      </a>
      <div class="work-readme" data-repo="tw-extensions"></div>
    </div>

  <script>
    async function fetchReadme(user, repo, container, maxLines = 3) {
      const url = `https://api.github.com/repos/${user}/${repo}/readme`;
      
      try {
        const res = await fetch(url, {
          headers: { Accept: 'application/vnd.github.v3.raw' }
        });

        if (!res.ok) {
          container.innerText = 'README が取得できませんでした';
          return;
        }

        const md = await res.text();
        const fullHtml = marked.parse(md);

        const lines = md.split('\n');
        const previewMd = lines.slice(0, maxLines).join('\n');
        const previewHtml = marked.parse(previewMd);

        // オーバーレイ用要素作成
        const overlay = document.createElement('div');
        overlay.className = 'read-more-overlay';
        overlay.innerHTML = `<a href="#" class="close-button">閉じる</a>${fullHtml}`;
        container.parentElement.appendChild(overlay);

        // ボタンを追加
        const btn = document.createElement('a');
        btn.href = '#';
        btn.className = 'read-more-button';
        btn.innerText = '続きを見る';
        container.appendChild(btn);

        // ボタンクリックでオーバーレイ表示
        btn.addEventListener('click', e => {
          e.preventDefault();
          overlay.style.display = 'block';
        });

        // 閉じるボタンクリックで非表示
        overlay.querySelector('.close-button').addEventListener('click', e => {
          e.preventDefault();
          overlay.style.display = 'none';
        });

        container.innerHTML = previewHtml;
        container.appendChild(btn);

      } catch (e) {
        container.innerText = 'エラーが発生しました';
      }
    }

    // 全ての .work-readme に対して処理
    document.querySelectorAll('.work-readme').forEach(div => {
      const repo = div.dataset.repo;
      fetchReadme('098orin', repo, div);
    });
  </script>
  </main>
</html>